
<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ShiftSync Pro - Shift Calendar</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;900&display=swap" rel="stylesheet">
    <style>
        :root {
            --app-bg: #000000;
        }
        body {
            font-family: 'Inter', sans-serif;
            background-color: var(--app-bg);
            transition: background-color 0.5s ease;
            overflow-x: hidden;
            -webkit-tap-highlight-color: transparent;
        }
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
        }
        .calendar-cell {
            min-height: 100px;
            transition: all 0.2s ease;
        }
        @media (min-width: 768px) {
            .calendar-cell { min-height: 140px; }
        }
        .glass {
            background: rgba(15, 23, 42, 0.4);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
        }
        .custom-scrollbar::-webkit-scrollbar {
            width: 6px;
        }
        .custom-scrollbar::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.1);
        }
        .custom-scrollbar::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 10px;
        }
        .shift-tag {
            font-size: 0.65rem;
            font-weight: 900;
            padding: 2px 6px;
            border-radius: 6px;
            margin-top: 2px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        .modal-overlay {
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(8px);
            transition: opacity 0.3s ease;
        }
        .stamp-active {
            transform: scale(1.1);
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.5);
        }
        .view-btn-active {
            background-color: #2563eb;
            color: white;
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.3);
        }
        #chart-svg path {
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }
    </style>
<script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@^19.2.4",
    "react-dom/": "https://esm.sh/react-dom@^19.2.4/",
    "react/": "https://esm.sh/react@^19.2.4/"
  }
}
</script>
</head>
<body class="text-slate-100 selection:bg-blue-500/30">
    <!-- Navigation -->
    <nav id="navbar" class="sticky top-0 z-40 border-b border-white/5 transition-all shadow-xl glass px-4 h-16 flex items-center justify-between">
        <div class="flex items-center gap-4">
            <h2 id="current-month-display" class="text-xl font-black text-white tracking-tight flex items-baseline gap-1.5">
                <span id="display-year" class="text-slate-500 text-sm font-bold">2024年</span>
                <span id="display-month" class="text-blue-500 text-2xl sm:text-3xl">10月</span>
            </h2>
            <div class="flex gap-1">
                <button id="prev-month" class="p-2 hover:bg-white/5 border border-white/5 rounded-xl transition-all active:scale-90">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="m15 18-6-6 6-6"/></svg>
                </button>
                <button id="next-month" class="p-2 hover:bg-white/5 border border-white/5 rounded-xl transition-all active:scale-90">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="m9 18 6-6-6-6"/></svg>
                </button>
            </div>
        </div>
        <div class="flex items-center gap-2">
            <!-- View Switcher -->
            <div class="flex bg-slate-900/50 p-1 rounded-xl border border-slate-700/50 mr-2">
                <button id="view-calendar" class="p-1.5 rounded-lg transition-all view-btn-active" title="カレンダー">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><rect width="18" height="18" x="3" y="4" rx="2"/><path d="M16 2v4M8 2v4M3 10h18"/></svg>
                </button>
                <button id="view-dashboard" class="p-1.5 rounded-lg transition-all text-slate-500 hover:text-white" title="ダッシュボード">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><rect width="18" height="18" x="3" y="3" rx="2"/><path d="M3 9h18M9 21V9"/></svg>
                </button>
            </div>

            <button id="toggle-stamp-mode" class="flex items-center gap-2 px-3 py-1.5 rounded-xl text-xs font-black transition-all bg-slate-900/50 border border-slate-700/50 text-slate-400 hover:text-blue-400">
                <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M12 20h9"/><path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"/></svg>
                <span class="hidden sm:inline">スタンプ</span>
            </button>
            <button id="open-settings" class="p-2 rounded-xl text-slate-500 hover:text-white hover:bg-white/5 transition-all">
                <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12.22 2h-.44a2 2 0 0 0-2 2 2 2 0 0 1-2 2 2 2 0 0 0-2 2 2 2 0 0 1-2 2 2 2 0 0 0-2 2v.44a2 2 0 0 0 2 2 2 2 0 0 1 2 2 2 2 0 0 0 2 2 2 2 0 0 1 2 2 2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2 2 2 0 0 1 2-2 2 2 0 0 0 2-2 2 2 0 0 1 2-2 2 2 0 0 0 2-2v-.44a2 2 0 0 0-2-2 2 2 0 0 1-2-2 2 2 0 0 0-2-2 2 2 0 0 1-2-2 2 2 0 0 0-2-2ZM12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"/></svg>
            </button>
        </div>
    </nav>

    <!-- Stamp Toolbar (Hidden by default) -->
    <div id="stamp-toolbar" class="hidden glass border-b border-white/5 p-2 animate-in slide-in-from-top duration-300">
        <div class="max-w-6xl mx-auto flex flex-wrap justify-center gap-2" id="stamp-list">
            <!-- Stamp buttons injected here -->
        </div>
    </div>

    <!-- Main Content -->
    <main class="max-w-[1400px] mx-auto p-4 md:p-6">
        <!-- Calendar View Container -->
        <div id="view-container-calendar">
            <div id="calendar-container" class="rounded-[2.5rem] shadow-2xl overflow-hidden border border-white/5 glass transition-all duration-700">
                <div id="calendar-weekdays" class="calendar-grid border-b border-white/5 bg-black/20 text-center py-4 text-xs font-black tracking-widest uppercase">
                    <!-- Weekdays injected here -->
                </div>
                <div id="calendar-days" class="calendar-grid">
                    <!-- Days injected here -->
                </div>
            </div>

            <!-- Selected Day Info (Calendar View Only) -->
            <div id="selected-day-panel" class="mt-6 max-w-2xl mx-auto hidden transition-all animate-in fade-in slide-in-from-bottom-2">
                <div class="glass border border-white/5 rounded-[2rem] p-5 shadow-2xl relative overflow-hidden">
                    <div class="absolute top-0 left-0 w-1.5 h-full bg-blue-600"></div>
                    <div class="flex justify-between items-center mb-4">
                        <div class="flex items-center gap-3">
                            <span id="selected-date-text" class="text-lg font-black text-white">10月24日 (木)</span>
                            <div id="selected-shift-tag" class="hidden"></div>
                        </div>
                        <button id="edit-selected-btn" class="p-2 bg-white/5 hover:bg-white/10 rounded-xl text-slate-400">
                            <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
                        </button>
                    </div>
                    <div id="selected-note-box" class="bg-black/40 rounded-2xl p-4 border border-white/5 text-sm text-slate-300 min-h-[60px] italic">
                        メモはありません
                    </div>
                    <div id="selected-time-box" class="flex gap-3 mt-4 hidden">
                        <div class="flex-1 bg-blue-500/5 rounded-2xl py-3 flex flex-col items-center">
                            <span class="text-[10px] font-black text-blue-500/50 uppercase">Start</span>
                            <span id="selected-start-time" class="text-lg font-black text-blue-400">09:00</span>
                        </div>
                        <div class="flex-1 bg-rose-500/5 rounded-2xl py-3 flex flex-col items-center">
                            <span class="text-[10px] font-black text-rose-500/50 uppercase">End</span>
                            <span id="selected-end-time" class="text-lg font-black text-rose-400">18:00</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Dashboard View Container (Hidden by default) -->
        <div id="view-container-dashboard" class="hidden animate-in fade-in slide-in-from-bottom-4 duration-500">
            <div class="max-w-4xl mx-auto space-y-6">
                <!-- Reality Cards -->
                <div class="flex flex-col sm:flex-row gap-4" id="reality-cards-container">
                    <!-- Today/Tomorrow cards injected here -->
                </div>

                <!-- Month Statistics -->
                <div class="glass border border-white/5 p-6 md:p-8 rounded-[2.5rem] shadow-2xl">
                    <h3 class="text-xs font-black text-slate-500 uppercase tracking-[0.2em] mb-6 flex items-center gap-2">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><path d="M3 3v18h18"/><path d="m19 9-5 5-4-4-3 3"/></svg>
                        今月のシフト集計
                    </h3>
                    
                    <div id="stats-grid" class="grid grid-cols-3 gap-3 mb-10">
                        <!-- Stats counters injected here -->
                    </div>

                    <div class="border-t border-white/5 pt-10">
                        <div class="flex flex-col md:flex-row items-center justify-center gap-12">
                            <!-- SVG Donut Chart -->
                            <div class="relative w-48 h-48 md:w-56 md:h-56">
                                <svg viewBox="-1 -1 2 2" class="transform -rotate-90 w-full h-full drop-shadow-2xl" id="chart-svg">
                                    <!-- Pie slices injected here -->
                                </svg>
                                <div class="absolute inset-0 flex flex-col items-center justify-center pointer-events-none">
                                    <span id="total-shifts-count" class="text-3xl md:text-4xl font-black text-white leading-none">0</span>
                                    <span class="text-[10px] font-black text-slate-500 uppercase tracking-widest mt-1">Total</span>
                                </div>
                            </div>

                            <!-- Legend -->
                            <div id="chart-legend" class="grid grid-cols-2 md:grid-cols-1 gap-3 w-full max-w-xs">
                                <!-- Legend items injected here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Shift Edit Modal -->
    <!-- (Existing Modal HTML unchanged) -->
    <div id="shift-modal" class="fixed inset-0 z-50 flex items-center justify-center p-4 modal-overlay hidden">
        <div class="w-full max-w-md glass border border-white/5 rounded-[2.5rem] shadow-2xl overflow-hidden animate-in zoom-in-95 duration-200">
            <div class="p-6 border-b border-white/5 flex justify-between items-center">
                <h3 id="modal-title" class="text-xl font-black text-white">シフトを編集</h3>
                <button class="close-modal p-2 text-slate-500 hover:text-white transition-colors">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M18 6 6 18M6 6l12 12"/></svg>
                </button>
            </div>
            <form id="shift-form" class="p-6 space-y-5">
                <input type="hidden" id="form-date">
                <div>
                    <label class="block text-[10px] font-black text-slate-500 uppercase tracking-widest mb-3">シフト種別</label>
                    <div id="shift-type-grid" class="grid grid-cols-3 gap-2">
                        <!-- Type buttons injected here -->
                    </div>
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label class="block text-[10px] font-black text-slate-500 uppercase tracking-widest mb-1.5">開始時間</label>
                        <input type="time" id="form-start" class="w-full px-4 py-3 bg-black/40 border border-white/5 rounded-2xl text-white outline-none focus:ring-2 focus:ring-blue-500/50">
                    </div>
                    <div>
                        <label class="block text-[10px] font-black text-slate-500 uppercase tracking-widest mb-1.5">終了時間</label>
                        <input type="time" id="form-end" class="w-full px-4 py-3 bg-black/40 border border-white/5 rounded-2xl text-white outline-none focus:ring-2 focus:ring-blue-500/50">
                    </div>
                </div>
                <div>
                    <label class="block text-[10px] font-black text-slate-500 uppercase tracking-widest mb-1.5">メモ</label>
                    <textarea id="form-note" rows="3" class="w-full px-4 py-3 bg-black/40 border border-white/5 rounded-2xl text-white outline-none focus:ring-2 focus:ring-blue-500/50 resize-none" placeholder="備考など..."></textarea>
                </div>
                <div class="pt-2 flex flex-col gap-3">
                    <button type="submit" class="w-full py-4 bg-blue-600 hover:bg-blue-700 text-white font-black rounded-2xl shadow-xl shadow-blue-600/20 active:scale-95 transition-all">保存する</button>
                    <button type="button" id="delete-shift-btn" class="w-full py-3 text-rose-500 font-bold hover:bg-rose-500/10 rounded-2xl transition-all hidden">このシフトを削除</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settings-modal" class="fixed inset-0 z-50 flex items-center justify-center p-4 modal-overlay hidden">
        <div class="w-full max-w-2xl glass border border-white/5 rounded-[2.5rem] shadow-2xl overflow-hidden max-h-[90vh] flex flex-col animate-in zoom-in-95">
            <div class="p-6 border-b border-white/5 flex justify-between items-center sticky top-0 bg-inherit z-10">
                <h3 class="text-xl font-black text-white flex items-center gap-2">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" class="text-blue-500"><path d="M12.22 2h-.44a2 2 0 0 0-2 2 2 2 0 0 1-2 2 2 2 0 0 0-2 2v.44a2 2 0 0 0 2 2 2 2 0 0 1 2 2 2 2 0 0 0 2 2 2 2 0 0 1 2 2 2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2 2 2 0 0 1 2-2 2 2 0 0 0 2-2 2 2 0 0 1 2-2 2 2 0 0 0 2-2v-.44a2 2 0 0 0-2-2 2 2 0 0 1-2-2 2 2 0 0 0-2-2 2 2 0 0 1-2-2 2 2 0 0 0-2-2ZM12 15a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z"/></svg>
                    アプリ設定
                </h3>
                <button class="close-settings p-2 text-slate-500 hover:text-white transition-colors">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M18 6 6 18M6 6l12 12"/></svg>
                </button>
            </div>
            <div class="p-6 overflow-y-auto custom-scrollbar space-y-8">
                <section>
                    <h4 class="text-xs font-black text-blue-500 uppercase tracking-[0.2em] mb-4">シフトカラー設定</h4>
                    <div id="settings-colors-grid" class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                        <!-- Color settings injected here -->
                    </div>
                </section>
                <section>
                    <h4 class="text-xs font-black text-blue-500 uppercase tracking-[0.2em] mb-4">カレンダー配色</h4>
                    <div id="settings-ui-grid" class="grid grid-cols-2 sm:grid-cols-3 gap-4">
                        <!-- UI theme settings injected here -->
                    </div>
                </section>
                <section>
                    <h4 class="text-xs font-black text-blue-500 uppercase tracking-[0.2em] mb-4">背景テーマ</h4>
                    <div id="background-presets" class="flex flex-wrap gap-3">
                        <!-- Presets injected here -->
                    </div>
                </section>
            </div>
            <div class="p-6 border-t border-white/5 flex gap-4">
                <button id="reset-settings" class="px-6 py-4 rounded-2xl border border-white/10 text-slate-400 hover:text-white hover:bg-white/5 transition-all text-sm font-bold flex-1">初期化</button>
                <button class="close-settings px-8 py-4 rounded-2xl bg-blue-600 text-white font-black hover:bg-blue-700 shadow-xl shadow-blue-600/20 active:scale-95 transition-all flex-[2]">完了</button>
            </div>
        </div>
    </div>

    <!-- FAB -->
    <button id="fab-add" class="fixed bottom-6 right-6 w-14 h-14 bg-blue-600 text-white rounded-2xl shadow-2xl flex items-center justify-center active:scale-90 transition-all border-4 border-black z-30">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><path d="M5 12h14M12 5v14"/></svg>
    </button>

    <script type="module" src="index.js"></script>
</body>
</html>
